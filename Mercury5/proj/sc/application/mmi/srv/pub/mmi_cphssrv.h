/**
* @file mmi_cphssrv.h
*
* State Machine Service - CPHSSRV
* Generated by XFSM v1.0, CodeVer=v0.24
*
* Class Id: CLSID_CPHSSRV
*
*
* @version $Id: mmi_cphssrv.h 33461 2009-06-16 08:06:40Z mark.yang $
*/
#ifndef __MMI_CPHSSRV_H__
#define __MMI_CPHSSRV_H__

#include "mmi_mae_common_def.h"
#include "mmi_mae_applet.h"
#include "mmi_mae_class.h"
#include "mmi_req_cphs.h"

enum
{
    CPHSSRV_VMInd_Mask = 1 << 1
   ,CPHSSRV_MailBox_Setting_Update_Mask = 2 << 1
   ,CPHSSRV_VMInd_Setting_Update_Mask = 4 << 1,
};
#define CPHSSRV_All_Evt_Mask 0xFFFFFFFF
typedef u32 CPHSSRV_Event_Mask_e;

typedef struct
{
    MMI_CPHS_Type_e Type;
    u8 NumberStatus;
    u8 Number[MailNumberSize + 1];//1: null terminator
}MMI_CPHS_MailBoxNumber_t;

/**
 * External Events
 */
#define CPHSSRV_EVT_VOICE_MAIL_IND              (CLSID_CPHSSRV << 16 | 1)
#define CPHSSRV_EVT_QUERY_VM_STATUS_CNF             (CLSID_CPHSSRV << 16 | 2)
#define CPHSSRV_EVT_QUERY_LINE_CNF              (CLSID_CPHSSRV << 16 | 3)
#define CPHSSRV_EVT_QUERY_MAIL_BOX              (CLSID_CPHSSRV << 16 | 4)
#define CPHSSRV_EVT_SET_MAIL_BOX_NUMBER             (CLSID_CPHSSRV << 16 | 5)
#define CPHSSRV_EVT_READ_FUNCTIONALITY              (CLSID_CPHSSRV << 16 | 6)
#define CPHSSRV_EVT_SET_REQUEST             (CLSID_CPHSSRV << 16 | 7)


/**
 * ICPHSSRV Interfaces
 */
#define INHERIT_ICPHSSRV(IName) \
    INHERIT_IHandler(IName); \
    MAE_Ret     (*RegisterListener)     ( IName * , void *instance, u32 mask);  \
    MAE_Ret     (*DeregisterListener)       ( IName * , void *instance, u32 mask);  \
    MAE_Ret     (*QueryVMStatusReq)     ( IName * , void *pCallerID, u8 u8DualMode);  \
    MAE_Ret     (*QueryLineReq)     ( IName * , void *pCallerID, u8 u8DualMode);  \
    MAE_Ret     (*QueryMailBoxReq)      ( IName * , void *pCallerID, u8 u8DualMode);  \
    MAE_Ret     (*SetMailBoxNumberReq)      ( IName * , void *pCallerID, u8 u8DualMode, MMI_CPHSSRV_Line_Service_e Line, MMI_CPHS_Type_e Type, u8 *pStrNumber);  \
    MAE_Ret     (*QueryVoiceMailIndicatorReq)       ( IName * , void *pCallerID, u8 u8DualMode);  \
    MAE_Ret     (*SetVoiceMailIndicatorReq)     ( IName * , void *pCallerID, u8 u8DualMode, MMI_CPHS_Mode_e Mode);  \
    MAE_Ret     (*GetMailBoxNumber)     ( IName * , u8 u8DualMode, MMI_CPHSSRV_Line_Service_e Line, MMI_CPHS_MailBoxNumber_t *pNumber, boolean *pbSavedInSIM);  \
    MAE_Ret     (*GetVoiceMailIndicatorSetting)     ( IName * , u8 u8DualMode, boolean *pbActive);  \
    MAE_Ret     (*CancelSetMailBoxNumberReq)        ( IName * , void *pCallerID, u8 u8DualMode, MMI_CPHSSRV_Line_Service_e Line);  \
    MAE_Ret     (*CancelSetVoiceMailIndicatorReq)       ( IName * , void *pCallerID, u8 u8DualMode)

DEFINE_INTERFACE(ICPHSSRV);


#define ICPHSSRV_QueryInterface(pICntlr, id, pp, po)            GET_FUNCTBL((pICntlr), ICPHSSRV)->QueryInterface(pICntlr, id, pp, po)
#define ICPHSSRV_HandleEvent(pICntlr, e, p1, p2)                GET_FUNCTBL((pICntlr), ICPHSSRV)->HandleEvent(pICntlr, e, p1, p2)
/**
 brief:   The interface is provided APPs to listenen CPHSSRV events that he interested.

@param[in]  instance                 Object pointer to the APP
@param[in]  mask                     Event mask

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM    If an error happen.
 */
#define ICPHSSRV_RegisterListener(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), ICPHSSRV)->RegisterListener( pICntlr, p1, p2)
/**
 brief:   The interface is provided APPs to stop listenen events that he interested.

@param[in]  instance                     Object pointer to the APP
@param[in]  mask                         Event mask

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM    If an error happen.
 */
#define ICPHSSRV_DeregisterListener(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), ICPHSSRV)->DeregisterListener( pICntlr, p1, p2)
/**
 brief:   The interface is provided APPs to send query_voice_mail_status req

@param[in]  pCallerID                        APP's instance
@param[in]  u8DualMode                   which SIM you want to query

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM    If an error happen.
 */
#define ICPHSSRV_QueryVMStatusReq(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), ICPHSSRV)->QueryVMStatusReq( pICntlr, p1, p2)
/**
 brief:   The interface is provided APPs to send query_Line_req

@param[in]  pCallerID                        APP's instance
@param[in]  u8DualMode                   which SIM you want to query

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM    If an error happen.
 */
#define ICPHSSRV_QueryLineReq(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), ICPHSSRV)->QueryLineReq( pICntlr, p1, p2)
/**
 brief:   The interface is provided APPs to send query_mail_box req

@param[in]  pCallerID                        APP's instance
@param[in]  u8DualMode                   which SIM you want to query

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM    If an error happen.
 */
#define ICPHSSRV_QueryMailBoxReq(pICntlr, p1, p2)   GET_FUNCTBL((pICntlr), ICPHSSRV)->QueryMailBoxReq( pICntlr, p1, p2)
/**
 brief:   The interface is provided APPs to send set_mail_box_number req

@param[in]  pCallerID                       APP's instance
@param[in]  u8DualMode                   which SIM you want to set
@param[in]  Line                              which Line you want to set
@param[in]  Type                            Number type (national/international)
@param[in]  pStrNumber                   Number with null terminator

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM    If an error happen.
 */
#define ICPHSSRV_SetMailBoxNumberReq(pICntlr, p1, p2, p3, p4, p5)   GET_FUNCTBL((pICntlr), ICPHSSRV)->SetMailBoxNumberReq( pICntlr, p1, p2, p3, p4, p5)
/**
 brief:   The interface is provided APPs to send read_functionality_req to get the voice mail indicator functionality is activate or deactivate

@param[in]  pCallerID                        APP's instance
@param[in]  u8DualMode                   which SIM you want to query

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM    If an error happen.
 */
#define ICPHSSRV_QueryVoiceMailIndicatorReq(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), ICPHSSRV)->QueryVoiceMailIndicatorReq( pICntlr, p1, p2)
/**
 brief:   The interface is provided APPs to send set_request to activate/deactivate the Voice Mail indicator

@param[in]  pCallerID                        APP's instance
@param[in]  u8DualMode                   which SIM you want to set_request
@param[in]  Mode                            activate/deactivate

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM    If an error happen.
 */
#define ICPHSSRV_SetVoiceMailIndicatorReq(pICntlr, p1, p2, p3)  GET_FUNCTBL((pICntlr), ICPHSSRV)->SetVoiceMailIndicatorReq( pICntlr, p1, p2, p3)
/**
 brief:   The interface is provided APPs to retrieve the mailbox number which keep in the cphs service

@param[in]  u8DualMode                   which SIM you want to get
@param[in]  Line                              which Line you want to get
@param[in]  pNumber                        The pointer of MMI_CPHS_MailBoxNumber_t structure (can't be NULL)
@param[out]  pbSavedInSIM              The pointer of the output boolean bSavedInSIM, if bSavedInSIM is FALSE means that the SIM doesn't support the CPHS and the number is saved in phone

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM       If an error happen.
@return MAE_RET_NOT_READY       Service still waiting the first request confirm
 */
#define ICPHSSRV_GetMailBoxNumber(pICntlr, p1, p2, p3, p4)  GET_FUNCTBL((pICntlr), ICPHSSRV)->GetMailBoxNumber( pICntlr, p1, p2, p3, p4)
/**
 brief:   The interface is provided APPs to retrieve the Voice Mail indicator setting (active/deactive)

@param[in]  u8DualMode                   which SIM you want to set_request
@param[in]  pbActiveMode                The boolean pointer (can't be NULL)

@return MAE_RET_SUCCESS           If successful.
@return MAE_RET_FAILED              If an error happen.
@return MAE_RET_BAD_PARAM       If an error happen.
@return MAE_RET_NOT_READY       Service still waiting for the first interrogate confirm
 */
#define ICPHSSRV_GetVoiceMailIndicatorSetting(pICntlr, p1, p2)  GET_FUNCTBL((pICntlr), ICPHSSRV)->GetVoiceMailIndicatorSetting( pICntlr, p1, p2)
/**
 brief:   The interface is provided APPs to cancel the mailbox number setting request and the setting confirm event. if the setting request is already set to ril layer, CPHS service will just cancel the confirm event, that means CPHS will release the reference of the request caller

@param[in]  pCallerID                    APP's instance
@param[in]  u8DualMode                which SIM that caller has ask to set mailbox number
@param[in]  Line                           which SIM that caller has ask to set mailbox number

@return MAE_RET_SUCCESS           If the request or the confirm event has been cancel successful.
@return MAE_RET_BAD_PARAM       If an error happen.
@return MAE_RET_NOT_FOUND       Service can't find the related request
 */
#define ICPHSSRV_CancelSetMailBoxNumberReq(pICntlr, p1, p2, p3) GET_FUNCTBL((pICntlr), ICPHSSRV)->CancelSetMailBoxNumberReq( pICntlr, p1, p2, p3)
/**
 brief:   The interface is provided APPs to cancel the VM indicator setting request and the setting confirm event. if the setting request is already set to ril layer, CPHS service will just cancel the confirm event, that means CPHS will release the reference of the request caller

@param[in]  pCallerID                    APP's instance
@param[in]  u8DualMode                which SIM that caller has ask to set VM indicator

@return MAE_RET_SUCCESS           If the request or the confirm event has been cancel successful.
@return MAE_RET_BAD_PARAM       If an error happen.
@return MAE_RET_NOT_FOUND       Service can't find the related request
 */
#define ICPHSSRV_CancelSetVoiceMailIndicatorReq(pICntlr, p1, p2)    GET_FUNCTBL((pICntlr), ICPHSSRV)->CancelSetVoiceMailIndicatorReq( pICntlr, p1, p2)



/**
 * Functions
 */

void CPHSSRV_Init(void);

__SLDPM_FREE__ MAE_Ret CPHSSRV_New(MAE_ClsId id, void **ppObj);

#endif /* __MMI_CPHSSRV_H__ */
